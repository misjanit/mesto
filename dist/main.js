(()=>{"use strict";class e{constructor(e,t){this._form=t,this._settings=e,this._inputs=Array.from(this._form.querySelectorAll(this._settings.inputSelector)),this._button=this._form.querySelector(this._settings.submitButtonSelector)}_showInputError(e){const{errorClass:t,inputErrorClass:n}=this._settings,s=this._form.querySelector(`#error-${e.id}`);e.classList.add(t),s.textContent=e.validationMessage,s.classList.add(n)}_hideInputError(e){const{errorClass:t,inputErrorClass:n}=this._settings,s=this._form.querySelector(`#error-${e.id}`);e.classList.remove(t),s.classList.remove(n),s.textContent=""}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_isInputInvalid(){return this._inputs.some((e=>!e.validity.valid))}toggleButtonState(){this._isInputInvalid()?(this._button.classList.add(this._settings.inactiveButtonClass),this._button.setAttribute("disabled",!0)):(this._button.classList.remove(this._settings.inactiveButtonClass),this._button.removeAttribute("disabled",""))}_setEventListeners(){this.toggleButtonState(),this._inputs.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this.toggleButtonState()}))}))}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}resetErrors(){this._form.reset(),this._inputs.forEach((e=>{this._hideInputError(e)})),this.toggleButtonState()}}const t={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__save-button",inactiveButtonClass:"popup__save-button_unactive",inputErrorClass:".popup__input-error",errorClass:"popup__input_redline"};class n{constructor(e,t,n){this._name=e.name,this._link=e.link,this._cardTemplate=t,this._handlePrewievPicture=n}_getTemplate(){return document.querySelector(this._cardTemplate).content.querySelector(".element").cloneNode(!0)}createCard(){return this._newElement=this._getTemplate(),this._element=this._newElement.querySelector(".element"),this._elementTitle=this._newElement.querySelector(".element__title"),this._elementImage=this._newElement.querySelector(".element__image"),this._elementLike=this._newElement.querySelector(".element__like"),this._deleteCard=this._newElement.querySelector("#delete-card"),this._elementImage.src=this._link,this._elementImage.alt=this._name,this._elementTitle.textContent=this._name,this._setEventListeners(),this._newElement}_setEventListeners(){this._elementImage.addEventListener("click",(()=>{this._handlePrewievPicture(this._link,this._name)})),this._elementLike.addEventListener("click",(()=>{this._handleLikeIcon()})),this._deleteCard.addEventListener("click",(()=>{this._handleDeleteCard()}))}_handleLikeIcon=()=>{this._elementLike.classList.toggle("element__like_active")};_handleDeleteCard(){this._newElement.remove(),this._newElement=null}}const s=document.querySelector(".elements"),r=document.querySelector(".profile__name"),o=document.querySelector(".profile__description"),i=document.querySelector("#popup-profile-form"),l=document.querySelector("#popup-edit-profile"),a=document.querySelector(".profile__edit-button"),u=document.querySelector("#username"),c=document.querySelector("#popup-profile-form"),d=document.querySelector(".profile__add-button"),p=document.querySelector("#popup-new-card"),_=document.querySelector("#popup-card-form"),m=(document.querySelector(".popup__save-button"),document.querySelector("#title")),h=document.querySelector("#image"),v=document.querySelectorAll(".popup"),y=document.querySelector("#description"),g=document.querySelector(".popup__image"),f=document.querySelector(".popup__description"),S=document.querySelector("#popup-modal"),E=new e(t,i),k=new e(t,_);function L(e){e.classList.add("popup_opened"),document.addEventListener("keydown",b)}function q(e){e.classList.remove("popup_opened"),document.removeEventListener("keydown",b)}function b(e){"Escape"===e.key&&q(document.querySelector(".popup_opened"))}function C(e,t){g.src=e,g.alt=t,f.textContent=t,L(S)}function w(e){return new n(e,"#template",C).createCard()}function I(e,t){t.prepend(e)}E.enableValidation(),k.enableValidation(),v.forEach((e=>{e.addEventListener("click",(t=>{t.target.classList.contains("popup_opened")&&q(e),t.target.classList.contains("popup__close-button")&&q(e)}))})),a.addEventListener("click",(function(){u.value=r.textContent,y.value=o.textContent,L(l),E.toggleButtonState()})),c.addEventListener("submit",(function(e){e.preventDefault(),r.textContent=u.value,o.textContent=y.value,q(l)})),[{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}].forEach((e=>{I(w(e),s)})),d.addEventListener("click",(function(){k.toggleButtonState(),L(p)})),_.addEventListener("submit",(function(e){e.preventDefault();const t={name:m.value,link:h.value};k.toggleButtonState(),I(w(t),s),q(p),e.target.reset()}))})();